<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.80">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Code and charts for the 2022 30-Day Chart Challenge">
<title>30DCC (2022) - 7&nbsp; Physical</title>
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><link href="./08-mountains.html" rel="next">
<link href="./06-owid.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
    "location": "sidebar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "start",
    "type": "textbox",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script type="text/javascript">

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-6NP3MF25W3', { 'anonymize_ip': true});
  </script><script type="application/json" class="js-hypothesis-config">
  {
    "theme": "clean",
    "openSidebar": false
  }
  </script><script async="" src="https://hypothes.is/embed.js"></script><!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]--><link rel="stylesheet" href="include/style.css">
</head>
<body class="floating">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Physical</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">30DCC (2022)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/debruine/30DCC-2022/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-comparisons" aria-expanded="true">Comparisons</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-comparisons" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-comparisons" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-part-to-whole.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Part-to-whole</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-pictogram.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Pictogram</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-historical.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Historical</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-flora.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Flora</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-slope.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Slope</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-owid.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">OWiD</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-distributions" aria-expanded="true">Distributions</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-distributions" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-distributions" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-physical.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Physical</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mountains.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Mountains</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-statistics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-experimental.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Experimental</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-circular.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Circular</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-economist.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Economist</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-relationships" aria-expanded="true">Relationships</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-relationships" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-relationships" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-correlation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Correlation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-3-dimensional.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">3-Dimensional</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-multivariate.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multivariate</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-environment.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Environment</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-connections.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Connections</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-oecd.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">OECD</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-timeseries" aria-expanded="true">Timeseries</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-timeseries" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-timeseries" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-global-change.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Global Change</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-new-tool.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">New Tool</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-down-upwards.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Down/Upwards</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-animation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Animation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-tiles.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Tiles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-financial-times.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Financial Times</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-uncertainties" aria-expanded="true">Uncertainties</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-uncertainties" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-uncertainties" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-trend.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Trend</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-interactive.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Interactive</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-future.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Future</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./28-deviations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Deviations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./29-storytelling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Storytelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30-un-population.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">UN Population</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-appendices" aria-expanded="true">Appendices</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-appendices" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-appendices" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-0-together.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Putting it all together</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-colours.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Colours</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-stained-glass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Stained Glass Heart</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-magic-eye.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Magic Eye</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-psyarxiv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">PsyArXiv</span></a>
  </div>
</li>
    </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#get-song-id" class="nav-link active" data-scroll-target="#get-song-id"> <span class="header-section-number">7.1</span> Get song ID</a></li>
<li><a href="#song-analysis" class="nav-link" data-scroll-target="#song-analysis"> <span class="header-section-number">7.2</span> Song Analysis</a></li>
<li><a href="#pitches" class="nav-link" data-scroll-target="#pitches"> <span class="header-section-number">7.3</span> Pitches</a></li>
<li><a href="#plot-pitch-by-beat" class="nav-link" data-scroll-target="#plot-pitch-by-beat"> <span class="header-section-number">7.4</span> Plot Pitch by Beat</a></li>
<li><a href="#plot-key-by-segment" class="nav-link" data-scroll-target="#plot-key-by-segment"> <span class="header-section-number">7.5</span> Plot Key by Segment</a></li>
<li><a href="#combine-plots" class="nav-link" data-scroll-target="#combine-plots"> <span class="header-section-number">7.6</span> Combine Plots</a></li>
<li><a href="#s-theme" class="nav-link" data-scroll-target="#s-theme"> <span class="header-section-number">7.7</span> 80s Theme</a></li>
</ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/debruine/30DCC-2022/edit/main/07-physical.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/debruine/30DCC-2022/issues/new" class="toc-action">Report an issue</a></p><p><a href="https://github.com/debruine/30DCC-2022/blob/main/07-physical.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header"><h1 class="title d-none d-lg-block display-7">
<span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Physical</span>
</h1>
</header><p>Every time I thought about today’s prompt, by brain started playing Let’s Get Physical by Olivia Newton John. If you haven’t watched the <a href="https://www.youtube.com/watch?v=vWz9VN40nCA">video</a>, it’s a real 80s experience. I’m going to try to theme the plot after the video.</p>
<p><img src="images/physical.png" class="img-fluid"></p>
<p>So I decided to adapt some code from a tutorial I wrote on <a href="https://psyteachr.github.io/ads-v1/spotify-data.html">spotifyr</a>, which is based on a <a href="https://mcmullarkey.github.io/mcm-blog/posts/2022-01-07-spotify-api-r/">tutorial by Michael Mullarkey</a>. You can check those tutorials for the setup details if you haven’t used <code class="package">spotifyr</code> before.</p>
<div class="cell" data-layout-align="center">
<details><summary>Setup</summary><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(spotifyr)   <span class="co"># to access Spotify</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)  <span class="co"># for data wrangling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="get-song-id" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="get-song-id">
<span class="header-section-number">7.1</span> Get song ID</h2>
<p>This step requires access to spotify and you can get timed out if you try to access it too much, so I always save the result of calls to an API in scripts and set that code chunk to <code>eval = FALSE</code> so it doesn’t run every time I render this book.</p>
<div class="cell" data-layout-align="center">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># set to eval = FALSE to avoid too many call to spotify API</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>onj <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="at">artist =</span> <span class="st">'Olivia Newton John'</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="at">include_groups =</span> <span class="st">"album"</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">saveRDS</span>(onj, <span class="st">"data/onj.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now I can search the tracks for “Physical”. I’ll choose the earliest release.</p>
<div class="cell" data-layout-align="center">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># read in saved object</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>onj <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/onj.rds"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>physical_id <span class="ot">&lt;-</span> onj <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">filter</span>(track_name <span class="sc">==</span> <span class="st">"Physical"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">filter</span>(album_release_year <span class="sc">==</span> <span class="fu">min</span>(album_release_year)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">pull</span>(track_id)</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a>physical_id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>[1] "273paQDMbi4JPeRfbYZuKx"</code></pre>
</div>
</div>
</section><section id="song-analysis" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="song-analysis">
<span class="header-section-number">7.2</span> Song Analysis</h2>
<p>Get the song analysis. It’s a list with a bunch of info.</p>
<div class="cell" data-layout-align="center">
<details><summary>Song analysis</summary><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># set to eval = FALSE to avoid too many call to spotify API</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>song_analysis <span class="ot">&lt;-</span> <span class="fu">get_track_audio_analysis</span>(physical_id)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">saveRDS</span>(song_analysis, <span class="st">"data/song_analysis.rmd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details><summary>Read in saved object</summary><div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># read in saved object</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>song_analysis <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/song_analysis.rmd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>
<code>meta</code> gives you a list of some info about the analysis.</li>
<li>
<code>track</code> gives you a list of attributes, including <code>duration</code>, <code>loudness</code>, <code>end_of_fade_in</code>, <code>start_of_fade_out</code>, and <code>time_signature</code>. Some of this info was available in the artist table.</li>
<li>
<code>bars</code>, <code>beats</code>, and <code>tatums</code> are tables with the <code>start</code>, <code>duration</code> and <code>confidence</code> for each bar, beat, or tatum of music (whatever a “tatum” is).</li>
<li>
<code>sections</code> is a table with the start, duration, loudness, tempo, key, mode, and time signature for each section of music, along with confidence measures of each.</li>
<li>
<code>segments</code> is a table with information about loudness, pitch and timbre of segments of analysis, which tend to be around 0.2 seconds.</li>
</ul></section><section id="pitches" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="pitches">
<span class="header-section-number">7.3</span> Pitches</h2>
<p>The column <code>pitches</code> of the segments table has 12 values representing the degree of occurrence for each note in each time segment, so we have to unpack this a bit.</p>
<div class="cell" data-layout-align="center">
<details><summary>Pitch analysis</summary><div class="sourceCode" id="cb7"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>pitch_analysis <span class="ot">&lt;-</span> song_analysis<span class="sc">$</span>segments <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">unnest</span>(pitches) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">rename</span>(<span class="at">pitch_degree =</span> pitches) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">group_by</span>(start) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">mutate</span>(<span class="at">pitch =</span> <span class="fu">row_number</span>()<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">filter</span>(pitch_degree <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">select</span>(start, duration, loudness_start, pitch)</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="fu">head</span>(pitch_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;"> start </th>
   <th style="text-align:right;"> duration </th>
   <th style="text-align:right;"> loudness_start </th>
   <th style="text-align:right;"> pitch </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.488 </td>
   <td style="text-align:right;"> -28.812 </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
<tr>
<td style="text-align:right;"> 0.488 </td>
   <td style="text-align:right;"> 0.359 </td>
   <td style="text-align:right;"> -25.662 </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
<tr>
<td style="text-align:right;"> 0.847 </td>
   <td style="text-align:right;"> 0.204 </td>
   <td style="text-align:right;"> -24.822 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.051 </td>
   <td style="text-align:right;"> 0.256 </td>
   <td style="text-align:right;"> -24.402 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.307 </td>
   <td style="text-align:right;"> 0.573 </td>
   <td style="text-align:right;"> -21.224 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.880 </td>
   <td style="text-align:right;"> 0.483 </td>
   <td style="text-align:right;"> -23.087 </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now I want to figure out the main pitch for each beat, so I need to somehow map the pitch table to the beat table. First, I need to work out the main segment in each beat.</p>
<div class="cell" data-layout-align="center">
<details><summary>Main pitch for each beat</summary><div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>seg <span class="ot">&lt;-</span> song_analysis<span class="sc">$</span>segments <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">select</span>(<span class="at">seg_start =</span> start, <span class="at">seg_dur =</span> duration)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>beat <span class="ot">&lt;-</span> song_analysis<span class="sc">$</span>beats <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">select</span>(<span class="at">beat_start =</span> start, <span class="at">beat_dur =</span> duration)</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a>main_seg_in_beat <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(seg, beat, <span class="at">by =</span> <span class="fu">character</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">mutate</span>(<span class="at">seg_end =</span> seg_start <span class="sc">+</span> seg_dur, </span>
<span id="cb8-9"><a href="#cb8-9"></a>         <span class="at">beat_end =</span> beat_start <span class="sc">+</span> beat_dur,</span>
<span id="cb8-10"><a href="#cb8-10"></a>         <span class="at">seg_in_beat =</span> (seg_start <span class="sc">&lt;=</span> beat_end) <span class="sc">&amp;</span> (seg_end <span class="sc">&gt;=</span> beat_start)) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">filter</span>(seg_in_beat) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="fu">mutate</span>(<span class="at">overlap =</span> <span class="fu">min</span>(seg_end, beat_end) <span class="sc">-</span> <span class="fu">max</span>(<span class="fu">c</span>(seg_start, beat_start)),</span>
<span id="cb8-14"><a href="#cb8-14"></a>         <span class="at">pcnt_in_beat =</span> overlap<span class="sc">/</span>beat_dur) <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="fu">group_by</span>(beat_start) <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> pcnt_in_beat, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="fu">head</span>(main_seg_in_beat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;"> seg_start </th>
   <th style="text-align:right;"> seg_dur </th>
   <th style="text-align:right;"> beat_start </th>
   <th style="text-align:right;"> beat_dur </th>
   <th style="text-align:right;"> seg_end </th>
   <th style="text-align:right;"> beat_end </th>
   <th style="text-align:left;"> seg_in_beat </th>
   <th style="text-align:right;"> overlap </th>
   <th style="text-align:right;"> pcnt_in_beat </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 0.488 </td>
   <td style="text-align:right;"> 0.359 </td>
   <td style="text-align:right;"> 0.504 </td>
   <td style="text-align:right;"> 0.460 </td>
   <td style="text-align:right;"> 0.847 </td>
   <td style="text-align:right;"> 0.964 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 0.344 </td>
   <td style="text-align:right;"> 0.747 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.051 </td>
   <td style="text-align:right;"> 0.256 </td>
   <td style="text-align:right;"> 0.964 </td>
   <td style="text-align:right;"> 0.473 </td>
   <td style="text-align:right;"> 1.307 </td>
   <td style="text-align:right;"> 1.437 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 0.256 </td>
   <td style="text-align:right;"> 0.541 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.307 </td>
   <td style="text-align:right;"> 0.573 </td>
   <td style="text-align:right;"> 1.437 </td>
   <td style="text-align:right;"> 0.474 </td>
   <td style="text-align:right;"> 1.880 </td>
   <td style="text-align:right;"> 1.910 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 0.443 </td>
   <td style="text-align:right;"> 0.936 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.880 </td>
   <td style="text-align:right;"> 0.483 </td>
   <td style="text-align:right;"> 1.910 </td>
   <td style="text-align:right;"> 0.469 </td>
   <td style="text-align:right;"> 2.363 </td>
   <td style="text-align:right;"> 2.380 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 0.452 </td>
   <td style="text-align:right;"> 0.964 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2.363 </td>
   <td style="text-align:right;"> 0.465 </td>
   <td style="text-align:right;"> 2.380 </td>
   <td style="text-align:right;"> 0.469 </td>
   <td style="text-align:right;"> 2.827 </td>
   <td style="text-align:right;"> 2.849 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 0.448 </td>
   <td style="text-align:right;"> 0.954 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2.827 </td>
   <td style="text-align:right;"> 0.446 </td>
   <td style="text-align:right;"> 2.849 </td>
   <td style="text-align:right;"> 0.474 </td>
   <td style="text-align:right;"> 3.274 </td>
   <td style="text-align:right;"> 3.322 </td>
   <td style="text-align:left;"> TRUE </td>
   <td style="text-align:right;"> 0.425 </td>
   <td style="text-align:right;"> 0.897 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
<p>And then join this with the pitch analysis table to get a main pitch for each beat.</p>
<div class="cell" data-layout-align="center">
<details><summary>Pitch by beat</summary><div class="sourceCode" id="cb9"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>pitch_by_beat <span class="ot">&lt;-</span> main_seg_in_beat <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">select</span>(<span class="at">start =</span> seg_start) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">left_join</span>(pitch_analysis, <span class="st">"start"</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">head</span>(pitch_by_beat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;"> start </th>
   <th style="text-align:right;"> duration </th>
   <th style="text-align:right;"> loudness_start </th>
   <th style="text-align:right;"> pitch </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 0.488 </td>
   <td style="text-align:right;"> 0.359 </td>
   <td style="text-align:right;"> -25.662 </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.051 </td>
   <td style="text-align:right;"> 0.256 </td>
   <td style="text-align:right;"> -24.402 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.307 </td>
   <td style="text-align:right;"> 0.573 </td>
   <td style="text-align:right;"> -21.224 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1.880 </td>
   <td style="text-align:right;"> 0.483 </td>
   <td style="text-align:right;"> -23.087 </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2.363 </td>
   <td style="text-align:right;"> 0.465 </td>
   <td style="text-align:right;"> -15.020 </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2.827 </td>
   <td style="text-align:right;"> 0.446 </td>
   <td style="text-align:right;"> -21.016 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="plot-pitch-by-beat" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="plot-pitch-by-beat">
<span class="header-section-number">7.4</span> Plot Pitch by Beat</h2>
<div class="cell" data-layout-align="center">
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">ggplot</span>(pitch_by_beat,</span>
<span id="cb10-2"><a href="#cb10-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> start, <span class="at">y =</span> pitch, <span class="at">color =</span> loudness_start)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07-physical_files/figure-html/physical-pitch-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-key-by-segment" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="plot-key-by-segment">
<span class="header-section-number">7.5</span> Plot Key by Segment</h2>
<p>I also wanted to map the key of each segment using a horizontal linerange, so I mapped it vertically first and flipped the coordinates.</p>
<div class="cell" data-layout-align="center">
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">ggplot</span>(song_analysis<span class="sc">$</span>sections, <span class="fu">aes</span>(<span class="at">ymin =</span> start, </span>
<span id="cb11-2"><a href="#cb11-2"></a>                               <span class="at">ymax =</span> start <span class="sc">+</span> duration,</span>
<span id="cb11-3"><a href="#cb11-3"></a>                               <span class="at">x =</span> key)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">geom_linerange</span>(<span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07-physical_files/figure-html/physical-key-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="combine-plots" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="combine-plots">
<span class="header-section-number">7.6</span> Combine Plots</h2>
<p>So to combine them, I need to move the data and mapping to the relevant geoms and swap the x and y coordinates for the pitch points.</p>
<div class="cell" data-layout-align="center">
<details><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">geom_linerange</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">ymin =</span> start, </span>
<span id="cb12-3"><a href="#cb12-3"></a>                               <span class="at">ymax =</span> start <span class="sc">+</span> duration,</span>
<span id="cb12-4"><a href="#cb12-4"></a>                               <span class="at">x =</span> key),</span>
<span id="cb12-5"><a href="#cb12-5"></a>                 <span class="at">data =</span> song_analysis<span class="sc">$</span>sections,</span>
<span id="cb12-6"><a href="#cb12-6"></a>                 <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> start, <span class="at">x =</span> pitch, <span class="at">color =</span> loudness_start),</span>
<span id="cb12-9"><a href="#cb12-9"></a>             <span class="at">data =</span> pitch_by_beat, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07-physical_files/figure-html/physical-combo-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="s-theme" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="s-theme">
<span class="header-section-number">7.7</span> 80s Theme</h2>
<p>Let’s remind ourselves of this monstrosity.</p>
<p><img src="images/physical.png" class="img-fluid"></p>
<div class="cell" data-layout-align="center">
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r cell-code number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># translate spotify's 0-11 to notes</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>pitch_key_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'C'</span>, <span class="st">'C#/Db'</span>, <span class="st">'D'</span>, <span class="st">'D#/Eb'</span>, <span class="st">'E'</span>, <span class="st">'F'</span>, </span>
<span id="cb13-3"><a href="#cb13-3"></a>                     <span class="st">'F#/Gb'</span>, <span class="st">'G'</span>, <span class="st">'G#/Ab'</span>, <span class="st">'A'</span>, <span class="st">'A#/Bb'</span>, <span class="st">'B'</span>)</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="fu">geom_linerange</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">ymin =</span> start, </span>
<span id="cb13-7"><a href="#cb13-7"></a>                               <span class="at">ymax =</span> start <span class="sc">+</span> duration,</span>
<span id="cb13-8"><a href="#cb13-8"></a>                               <span class="at">x =</span> key),</span>
<span id="cb13-9"><a href="#cb13-9"></a>                 <span class="at">data =</span> song_analysis<span class="sc">$</span>sections,</span>
<span id="cb13-10"><a href="#cb13-10"></a>                 <span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb13-11"><a href="#cb13-11"></a>                 <span class="at">color =</span> <span class="st">"#60E1FE"</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> start, <span class="at">x =</span> pitch, <span class="at">alpha =</span> loudness_start),</span>
<span id="cb13-14"><a href="#cb13-14"></a>             <span class="at">data =</span> pitch_by_beat, </span>
<span id="cb13-15"><a href="#cb13-15"></a>             <span class="at">color =</span> <span class="st">"#BB1DA8"</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb13-16"><a href="#cb13-16"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">250</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">11</span>,</span>
<span id="cb13-19"><a href="#cb13-19"></a>                     <span class="at">labels =</span> pitch_key_vals) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>  <span class="fu">scale_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Key/Pitch"</span>,</span>
<span id="cb13-22"><a href="#cb13-22"></a>       <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-23"><a href="#cb13-23"></a>       <span class="at">title =</span> <span class="st">"Let's Get Physical — Olivia Newton John"</span>,</span>
<span id="cb13-24"><a href="#cb13-24"></a>       <span class="at">subtitle =</span> <span class="st">"Main pitch for each beat (in pink) and key for each segment (in blue)"</span>,</span>
<span id="cb13-25"><a href="#cb13-25"></a>       <span class="at">caption =</span> <span class="st">"Data from Spotify via spotifyr | plot by @lisadebruine"</span>)  <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"red"</span>),</span>
<span id="cb13-28"><a href="#cb13-28"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#091131"</span>),</span>
<span id="cb13-29"><a href="#cb13-29"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-30"><a href="#cb13-30"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="07-physical_files/figure-html/physical-theme-1.png" class="img-fluid" alt="OK, that’s awful and I’m sorry.">{fig-align=‘center’ fig-alt=‘Chart of Let’s Get Physical by Olivia Newton John, showing the main pitch for each beat (in pink) and key for each segment (in blue). The 80s visual theme is reminiscent of the gym from the music video for the song.’ width=100%}</p>
</div>
</div>


</section></main><!-- /main --><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./06-owid.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">OWiD</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-mountains.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Mountains</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">CC-BY 2022, Lisa DeBruine</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/debruine/30DCC-2022">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/lisadebruine">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>